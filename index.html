<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hello Bulma!</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
  </head>
  <body>
  <section class="section">
    <div class="container">
      <h1 class="title">
        IOT
      </h1>
    <div class="columns">
            <div class="column">
                <h2 class="title">Arduino 1</h1>
                  <div id="divArduino1">
                    Temperatura CPU: <div id="tempCPU1"></div>
                    Temperatura Arduino: <div id="tempArduino1"></div>
                  </div>
            </div>
            <div class="column">
                <h2 class="title">Arduino 2</h1>
                  <div id="divArduino2">
                    Temperatura CPU: <div id="tempCPU2"></div>
                    Temperatura Arduino: <div id="tempArduino2"></div>
                  </div>
            </div>
            <div class="column">
                <h2 class="title">Arduino 3</h1>
                  <div id="divArduino3">
                      Temperatura CPU: <div id="tempCPU3"></div>
                      Temperatura Arduino: <div id="tempArduino3"></div>
                  </div>
            </div>
            <div class="column">
                <h2 class="title">Arduino 4</h1>
                  <div id="divArduino4">
                      Temperatura CPU: <div id="tempCPU4"></div>
                      Temperatura Arduino: <div id="tempArduino4"></div>
                  </div>
            </div>
          </div>
        </div>
    <div class="field">
        <input id="switchExample" type="checkbox" name="switchExample" class="switch" checked="checked">
        <label for="switchExample">Switch example</label>
      </div>
  </section>
    <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-database.js"></script>
    <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyABJRFnIdfLyNCwvT1xg-gd-GNJzdpOpYA",
        authDomain: "bd-grupo-03.firebaseapp.com",
        databaseURL: "https://bd-grupo-03.firebaseio.com",
        projectId: "bd-grupo-03",
        storageBucket: "bd-grupo-03.appspot.com",
        messagingSenderId: "891548880702",
        appId: "1:891548880702:web:931da7894252d7f1e1266f",
        measurementId: "G-9H5KS8CCLQ"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    var test = document.getElementById('test')

    var arduinos = ["arduino1","arduino2","arduino3","arduino4"]
    var arduinoDivs = ["divArduino1","divArduino2","divArduino3","divArduino4"]

    var refData = firebase.database().ref('arduino1').limitToLast(100)

    window.onload = (function(e) {
      for (i = 0 ; i < arduinos.length ; i++) {
      getDataFromFirebase(arduinos[i], i+1)
    };
    });



  function getDataFromFirebase(nomArduino, numDiv){
    var refData = firebase.database().ref(nomArduino).limitToLast(100)
    refData.on('value', function(data){
      // coger nombre de da
      var key = Object.keys(data.val())[0]
      console.log(key)
      console.log(data.length);
      var tempCPU = data.val().Temperatura_Cpu || 'error';
      var tempAr = data.val().Temperatura_Arduino || 'error';
      document.getElementById("tempCPU"+numDiv).innerHTML = tempCPU
      document.getElementById("tempArduino"+numDiv).innerHTML = tempCPU
    })
  }
    </script>
  <script src="main.js"></script>
  </body>
</html>